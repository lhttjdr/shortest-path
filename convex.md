圆的集合 $\{s_1,s_2,\dots,s_n\}$。求凸包$S$。

拓展到3维中，全部的圆在$z=0$平面上。圆$s$的圆心位于 $(x, y)$，半径为$r$， 映射$p$将圆映射到3维坐标
$$p:s\to p(s)=(x,y,r)$$

设$P$是点集 $\{p(s_1),p(s_2),\cdots,p(s_n)\}$ 的一个3维凸包。$\lambda_0$ 是任意一个底面在$z=0$坐标面，顶角为 $\pi/4$ 的圆锥。

设 $\lambda(s)$ 是一个圆锥，可以认为是 $\lambda_0$ 平移，放缩得到的。它的顶点在$p(s)$。 显然，$\lambda(s)$ 与$z=0$的交线就是圆$s$。


设 $\Lambda$ 是圆锥集合 $\{\lambda(s_1),\lambda(s_2),\cdots,\lambda(s_n)\}$ 的凸包。那么该凸包与$z=0$平面的交线就是圆集合的凸包$S$。

+-----+----------+
| $P$ | $S$      |
+-----+----------+
| 线  |   点（弧）|
+-----+----------+
| 面  |    线    |
+-----+----------+

设$O^\prime$ 是凸包$P$ 内一点。

平面中任何一经过凸包$S$上的直线，等同于三维空间中唯一平面$H$与$z=0$的交线，当且仅当$H$满足如下三个条件
-   $H$是经过凸包$P$的
-   $H$可由 $\lambda_0$沿某条母线的切平面平移得到的
-   $H$位于$O^\prime$ 的上方

反之，也成立。（可见求解$P$和$H$即可得到$S$）

**证明**
设$S$上某个点。位于$S$上1个圆上（即弧部分），$H$则经过1个圆锥。位于0个圆上（即切线部分），则$H$经过2个圆锥。而且$H$经过凸包 $\Lambda$的。（暂略）

特别地，如果所有的圆半径相同，则所有圆锥的顶点位于同一平面上。$P$退化成一个平面的凸包。圆锥底半径也相同，所以就是把$P$增大一圈就得到$S$了。

对于$O^\prime$的极性就是点和面的一一映射。将坐标系原点平移到$O^\prime$。对于空间中除$O^\prime$的任意一点$M$,点集
$$M^\ast=\{X^\prime\mid M\cdot X^\prime =1\}$$
构成$M$的极面。对称地，
对于面$H$，存在唯一一个极点$H^\ast$，满足
$$\forall X^\prime\in H,\qquad H^\ast\cdot X^\prime =1$$
显然地，
$$(M^\ast)^\ast=M,\qquad (H^\ast)^\ast=H$$

设$H^{\ast-}$ 是以$H$ 为界在$O^\prime$ 一侧的半空间。

设一系列平面构成的集合，对应地其平面的的极点构成集合，称为该平面集合的极集。

**性质**
1. 多面体$P^\prime=p(s_1)^{\ast-}\cap p(s_2)^{\ast-}\cap\cdots\cap p(s_n)^{\ast-}$ 和多面体$P$是对偶的。
2. 所有 $\lambda_0$ 平移而来的切平面的极集构成一个顶点位于$O^\prime$，顶角为 $\pi/4$ 倒立的圆锥，记为$K$。
3. $O^\ast$之上的平面，对应的极集是半空间 $z^\prime >0$。

**对应关系**

+-----+----------+----+
| $P$ | $P^\ast$ |  S |
+-----+----------+----+
| 点  |    面    |  点 |
+-----+----------+----+
| 线  |    线    |  线 |
+-----+----------+----+
| 面  |    点    |     |
+-----+----------+----+

问题转化为在 $P*\cap K\cap \{z^\prime>0\}$ 中判断点的问题。

有了点，即可得到 $S$ 中的线。然后把公切线连起来即可。
